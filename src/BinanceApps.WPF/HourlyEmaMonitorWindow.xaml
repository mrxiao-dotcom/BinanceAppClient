<Window x:Class="BinanceApps.WPF.HourlyEmaMonitorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:BinanceApps.WPF"
        Title="å°æ—¶å‡çº¿ç›‘æŽ§" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">
    
    <Window.Resources>
        <local:PriceChangeColorConverter x:Key="PriceChangeColorConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- æŽ§åˆ¶åŒºåŸŸ -->
        <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="20" Margin="10,10,10,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- æ ‡é¢˜ -->
                <TextBlock Grid.Row="0" Text="å°æ—¶å‡çº¿ç›‘æŽ§" 
                           FontSize="24" FontWeight="Bold" 
                           Foreground="#333333" Margin="0,0,0,20"/>
                
                <!-- æŽ§åˆ¶é¢æ¿ -->
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- ç¬¬ä¸€è¡Œï¼šä¸»è¦æŒ‰é’® -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- å·¦ä¾§ï¼šæŒ‰é’®åŒºåŸŸ -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Button x:Name="btnFetchKlines" Content="ðŸ“¥ èŽ·å–å°æ—¶Kçº¿" 
                                    Width="160" Height="40" 
                                    Background="#007ACC" Foreground="White"
                                    FontSize="15" FontWeight="Bold"
                                    Click="BtnFetchKlines_Click" Margin="0,0,10,0"/>
                            
                            <Button x:Name="btnUpdateKlines" Content="ðŸ”„ æ›´æ–°Kçº¿" 
                                    Width="120" Height="40" 
                                    Background="#17A2B8" Foreground="White"
                                    FontSize="15" FontWeight="Bold"
                                    Click="BtnUpdateKlines_Click" Margin="0,0,10,0"
                                    IsEnabled="False"/>
                            
                            <Button x:Name="btnCalculate" Content="ðŸ”¢ è®¡ç®—" 
                                    Width="100" Height="40" 
                                    Background="#FFC107" Foreground="White"
                                    FontSize="15" FontWeight="Bold"
                                    Click="BtnCalculate_Click" Margin="0,0,10,0"
                                    IsEnabled="False"/>
                            
                            <Button x:Name="btnOpenFloatingMonitor" Content="ðŸŽ¯ æ‰“å¼€æµ®çª—" 
                                    Width="120" Height="40" 
                                    Background="#6F42C1" Foreground="White"
                                    FontSize="15" FontWeight="Bold"
                                    Click="BtnOpenFloatingMonitor_Click" Margin="0,0,10,0"
                                    IsEnabled="True"/>
                            
                            <Button x:Name="btnClearCache" Content="ðŸ—‘ï¸ æ¸…é™¤ç¼“å­˜" 
                                    Width="120" Height="40" 
                                    Background="#6C757D" Foreground="White"
                                    FontSize="15" FontWeight="Bold"
                                    Click="BtnClearCache_Click" Margin="0,0,10,0"/>
                        </StackPanel>
                        
                        <!-- å³ä¾§ï¼šå‚æ•°åŒºåŸŸ -->
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <StackPanel Margin="0,0,15,0">
                                <TextBlock Text="Nå¤©å‡çº¿" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtEmaPeriod" Text="26" Width="80" 
                                         Height="30" FontSize="14"
                                         ToolTip="è®¡ç®—è¿‡åŽ»Nä¸ªKçº¿çš„EMAå‡å€¼"/>
                            </StackPanel>
                            
                            <StackPanel>
                                <TextBlock Text="Xæ ¹Kçº¿" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="txtKlineCount" Text="100" Width="80" 
                                         Height="30" FontSize="14"
                                         ToolTip="èŽ·å–æœ€è¿‘Xæ ¹1å°æ—¶Kçº¿"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                    
                    <!-- ç¬¬äºŒè¡Œï¼šç­›é€‰æ¡ä»¶ -->
                    <Grid Grid.Row="1" Margin="0,10,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- ç¬¬ä¸€æŽ’ç­›é€‰æ¡ä»¶ -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal">
                            <TextBlock Text="ç­›é€‰æ¡ä»¶ï¼š" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            
                            <TextBlock Text="å¤§äºŽEMAæ•°é‡ â‰¥" VerticalAlignment="Center" Margin="0,0,5,0"/>
                            <TextBox x:Name="txtMinAboveEma" Width="60" Height="30" 
                                     ToolTip="ç­›é€‰å¤§äºŽEMAæ•°é‡å¤§äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦"/>
                            
                            <TextBlock Text="å°äºŽEMAæ•°é‡ â‰¥" VerticalAlignment="Center" Margin="15,0,5,0"/>
                            <TextBox x:Name="txtMinBelowEma" Width="60" Height="30" 
                                     ToolTip="ç­›é€‰å°äºŽEMAæ•°é‡å¤§äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦"/>
                            
                            <TextBlock Text="æˆäº¤é¢(USDT) â‰¥" VerticalAlignment="Center" Margin="15,0,5,0"/>
                            <TextBox x:Name="txtMinQuoteVolume" Width="100" Height="30" 
                                     ToolTip="ç­›é€‰24Hæˆäº¤é¢å¤§äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦ï¼ˆå•ä½ï¼šUSDTï¼‰"/>
                            
                            <TextBlock Text="é‡æ¯”(%) â‰¥" VerticalAlignment="Center" Margin="15,0,5,0"/>
                            <TextBox x:Name="txtMinVolumeRatio" Width="60" Height="30" 
                                     ToolTip="ç­›é€‰é‡æ¯”å¤§äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦ï¼ˆå•ä½ï¼š%ï¼‰"/>
                            
                            <TextBlock Text="æµé€šçŽ‡(%) â‰¤" VerticalAlignment="Center" Margin="15,0,5,0"/>
                            <TextBox x:Name="txtMaxCirculationRate" Width="60" Height="30" 
                                     ToolTip="ç­›é€‰æµé€šçŽ‡å°äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦ï¼ˆå•ä½ï¼š%ï¼‰"/>
                            
                            <TextBlock Text="æµé€šå¸‚å€¼ â‰¤" VerticalAlignment="Center" Margin="15,0,5,0"/>
                            <TextBox x:Name="txtMaxCirculatingMarketCap" Width="100" Height="30" 
                                     ToolTip="ç­›é€‰æµé€šå¸‚å€¼å°äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦ï¼ˆå•ä½ï¼šUSDTï¼‰"/>
                            
                            <TextBlock Text="å‘è¡Œå¸‚å€¼ â‰¤" VerticalAlignment="Center" Margin="15,0,5,0"/>
                            <TextBox x:Name="txtMaxTotalMarketCap" Width="100" Height="30" 
                                     ToolTip="ç­›é€‰å‘è¡Œå¸‚å€¼å°äºŽç­‰äºŽæ­¤å€¼çš„åˆçº¦ï¼ˆå•ä½ï¼šUSDTï¼‰"/>
                        </StackPanel>
                        
                        <!-- ç¬¬äºŒæŽ’æ“ä½œæŒ‰é’® -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                            <Button x:Name="btnFilter" Content="ðŸ” ç­›é€‰" 
                                    Width="100" Height="30" 
                                    Background="#007ACC" Foreground="White"
                                    FontWeight="Bold"
                                    Click="BtnFilter_Click"/>
                            
                            <Button x:Name="btnClearFilter" Content="æ¸…é™¤ç­›é€‰" 
                                    Width="100" Height="30" 
                                    Background="#6C757D" Foreground="White"
                                    FontWeight="Bold" Margin="10,0,0,0"
                                    Click="BtnClearFilter_Click"/>
                            
                            <CheckBox x:Name="chkApplyFilterToMonitor" 
                                      Content="ç›‘æŽ§æ—¶è‡ªåŠ¨åº”ç”¨ç­›é€‰" 
                                      VerticalAlignment="Center" 
                                      Margin="20,0,0,0"
                                      FontWeight="SemiBold"
                                      ToolTip="å¯åŠ¨ç›‘æŽ§æ—¶è‡ªåŠ¨åº”ç”¨å½“å‰ç­›é€‰æ¡ä»¶ï¼Œåªæ˜¾ç¤ºç¬¦åˆæ¡ä»¶çš„åˆçº¦"/>
                            
                            <!-- ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º -->
                            <Border BorderBrush="#28A745" BorderThickness="1" CornerRadius="3" 
                                    Padding="8,5" Margin="30,0,0,0" Background="#F0FFF4">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“Š ç»Ÿè®¡ï¼š" FontWeight="Bold" 
                                               VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBlock Text="å‡çº¿ä»¥ä¸Šï¼š" VerticalAlignment="Center" 
                                               Foreground="#28A745" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtAboveEmaCount" Text="0" 
                                               VerticalAlignment="Center" Margin="3,0,15,0"
                                               Foreground="#28A745" FontWeight="Bold" FontSize="14"/>
                                    <TextBlock Text="å‡çº¿ä»¥ä¸‹ï¼š" VerticalAlignment="Center" 
                                               Foreground="#DC3545" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtBelowEmaCount" Text="0" 
                                               VerticalAlignment="Center" Margin="3,0,0,0"
                                               Foreground="#DC3545" FontWeight="Bold" FontSize="14"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Grid>
        </Border>
        
        <!-- æ•°æ®å±•ç¤ºåŒºåŸŸ -->
        <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="10" Margin="10,5,10,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- ç»“æžœæ ‡é¢˜å’Œæç¤º -->
                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <TextBlock x:Name="txtResultTitle" 
                               Text="ç›‘æŽ§ç»“æžœ" FontSize="18" FontWeight="Bold" 
                               Foreground="#333333" VerticalAlignment="Center"
                               HorizontalAlignment="Left"/>
                    <TextBlock Text="ðŸ’¡ åŒå‡»ï¼šå¤åˆ¶åˆçº¦å | Ctrl+åŒå‡»ï¼šæŸ¥çœ‹Kçº¿å›¾è¡¨" 
                               FontSize="11" 
                               Foreground="#999999" 
                               HorizontalAlignment="Right" 
                               VerticalAlignment="Bottom"
                               Margin="0,0,0,2"/>
                </Grid>
                
                <!-- æ•°æ®è¡¨æ ¼ -->
                <DataGrid Grid.Row="1" x:Name="dgResults" 
                          AutoGenerateColumns="False" 
                          CanUserAddRows="False" 
                          CanUserDeleteRows="False"
                          IsReadOnly="True"
                          GridLinesVisibility="Horizontal"
                          HeadersVisibility="Column"
                          AlternatingRowBackground="#F8F9FA"
                          RowHeaderWidth="0"
                          SelectionMode="Single"
                          MouseDoubleClick="DgResults_MouseDoubleClick">
                    
                    <!-- å³é”®èœå• -->
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="ðŸ“ˆ åŠ å…¥å¤šå¤´ç›‘æŽ§" Click="MenuItem_AddToLongMonitor_Click"/>
                            <MenuItem Header="ðŸ“‰ åŠ å…¥ç©ºå¤´ç›‘æŽ§" Click="MenuItem_AddToShortMonitor_Click"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                    
                    <DataGrid.Columns>
                        <!-- åˆçº¦å -->
                        <DataGridTextColumn Header="åˆçº¦å" Binding="{Binding Symbol}" 
                                            Width="120" FontWeight="Bold"/>
                        
                        <!-- æœ€æ–°ä»·æ ¼ -->
                        <DataGridTextColumn Header="æœ€æ–°ä»·æ ¼" Binding="{Binding LastPrice, StringFormat=F8}" 
                                            Width="120"/>
                        
                        <!-- å½“å‰EMA -->
                        <DataGridTextColumn Header="å½“å‰EMA" Binding="{Binding CurrentEma, StringFormat=F8}" 
                                            Width="120"/>
                        
                        <!-- è·ç¦»EMA -->
                        <DataGridTextColumn Header="è·ç¦»EMA(%)" Binding="{Binding DistancePercent, StringFormat=F2}" 
                                            Width="100" SortDirection="Ascending">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{Binding DistancePercent, Converter={StaticResource PriceChangeColorConverter}}"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        
                        <!-- å¤§äºŽEMAæ•°é‡ -->
                        <DataGridTextColumn Header="å¤§äºŽEMAæ•°é‡" Binding="{Binding AboveEmaCount}" 
                                            Width="110" FontWeight="Bold"/>
                        
                        <!-- å°äºŽEMAæ•°é‡ -->
                        <DataGridTextColumn Header="å°äºŽEMAæ•°é‡" Binding="{Binding BelowEmaCount}" 
                                            Width="110" FontWeight="Bold"/>
                        
                        <!-- 24Hæ¶¨å¹… -->
                        <DataGridTextColumn Header="24Hæ¶¨å¹…(%)" Binding="{Binding PriceChangePercent, StringFormat=F2}" 
                                            Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{Binding PriceChangePercent, Converter={StaticResource PriceChangeColorConverter}}"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        
                        <!-- Kçº¿æ•°é‡ -->
                        <DataGridTextColumn Header="Kçº¿æ•°é‡" Binding="{Binding KlineCount}" 
                                            Width="80"/>
                        
                        <!-- 24Hæˆäº¤é¢ -->
                        <DataGridTextColumn Header="24Hæˆäº¤é¢(USDT)" Binding="{Binding QuoteVolumeText}" 
                                            Width="150"/>
                        
                        <!-- æµé€šé‡ -->
                        <DataGridTextColumn Header="æµé€šé‡" Binding="{Binding CirculatingSupply, StringFormat=N0}" 
                                            Width="120"/>
                        
                        <!-- å‘è¡Œæ€»é‡ -->
                        <DataGridTextColumn Header="å‘è¡Œæ€»é‡" Binding="{Binding TotalSupply, StringFormat=N0}" 
                                            Width="120"/>
                        
                        <!-- æµé€šçŽ‡ -->
                        <DataGridTextColumn Header="æµé€šçŽ‡(%)" Binding="{Binding CirculationRate, StringFormat=F2}" 
                                            Width="90"/>
                        
                        <!-- é‡æ¯”(%) -->
                        <DataGridTextColumn Header="é‡æ¯”(%)" Binding="{Binding VolumeRatio, StringFormat=F2}" 
                                            Width="80"/>
                        
                        <!-- æµé€šå¸‚å€¼ -->
                        <DataGridTextColumn Header="æµé€šå¸‚å€¼(USDT)" Binding="{Binding CirculatingMarketCap, StringFormat=N0}" 
                                            Width="150"/>
                        
                        <!-- å‘è¡Œå¸‚å€¼ -->
                        <DataGridTextColumn Header="å‘è¡Œå¸‚å€¼(USDT)" Binding="{Binding TotalMarketCap, StringFormat=N0}" 
                                            Width="150"/>
                        
                        <!-- åˆçº¦ç®€ä»‹ -->
                        <DataGridTextColumn Header="åˆçº¦ç®€ä»‹" Binding="{Binding Description}" 
                                            Width="200"/>
                        
                        <!-- æ›´æ–°æ—¶é—´ -->
                        <DataGridTextColumn Header="æ›´æ–°æ—¶é—´" Binding="{Binding UpdateTime, StringFormat=HH:mm:ss}" 
                                            Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>
        
        <!-- çŠ¶æ€æ  -->
        <StatusBar Grid.Row="2" Background="#F8F9FA" Height="30">
            <StatusBarItem>
                <TextBlock x:Name="txtStatus" Text="å°±ç»ª" />
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="txtProgress" Text="" FontSize="10" Foreground="Gray"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>

