<Window x:Class="BinanceApps.WPF.VolumeRatioWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:BinanceApps.WPF"
        Title="é‡æ¯”å¼‚åŠ¨é€‰è‚¡" Height="800" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">
    
    <Window.Resources>
        <local:PriceChangeColorConverter x:Key="PriceChangeColorConverter"/>
        <local:VolumeRatioColorConverter x:Key="VolumeRatioColorConverter"/>
        <local:MaDistanceColorConverter x:Key="MaDistanceColorConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- ç­›é€‰æ¡ä»¶åŒºåŸŸ -->
        <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="20" Margin="10,10,10,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- æ ‡é¢˜ -->
                <TextBlock Grid.Row="0" Text="é‡æ¯”å¼‚åŠ¨é€‰è‚¡" 
                           FontSize="24" FontWeight="Bold" 
                           Foreground="#333333" Margin="0,0,0,20"/>
                
                <!-- ç­›é€‰æ¡ä»¶ -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- æµé€šå¸‚å€¼ç­›é€‰ -->
                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                        <TextBlock Text="æµé€šå¸‚å€¼èŒƒå›´(ä¸‡)" FontWeight="Bold" Margin="0,0,0,5"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="txtMinMarketCap" Grid.Column="0" 
                                     Text="0" Margin="0,0,5,0" 
                                     ToolTip="æœ€å°æµé€šå¸‚å€¼(ä¸‡)"/>
                            <TextBlock Grid.Column="1" Text="~" VerticalAlignment="Center" Margin="5,0"/>
                            <TextBox x:Name="txtMaxMarketCap" Grid.Column="2" 
                                     Text="100000" Margin="5,0,0,0"
                                     ToolTip="æœ€å¤§æµé€šå¸‚å€¼(ä¸‡)"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- é‡æ¯”ç­›é€‰ -->
                    <StackPanel Grid.Column="1" Margin="0,0,15,0">
                        <TextBlock Text="é‡æ¯”èŒƒå›´" FontWeight="Bold" Margin="0,0,0,5"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="txtMinVolumeRatio" Grid.Column="0" 
                                     Text="0.1" Margin="0,0,5,0"
                                     ToolTip="æœ€å°é‡æ¯”"/>
                            <TextBlock Grid.Column="1" Text="~" VerticalAlignment="Center" Margin="5,0"/>
                            <TextBox x:Name="txtMaxVolumeRatio" Grid.Column="2" 
                                     Text="10" Margin="5,0,0,0"
                                     ToolTip="æœ€å¤§é‡æ¯”"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- 24Hæˆäº¤é¢ç­›é€‰ -->
                    <StackPanel Grid.Column="2" Margin="0,0,15,0">
                        <TextBlock Text="24Hæˆäº¤é¢èŒƒå›´(ä¸‡)" FontWeight="Bold" Margin="0,0,0,5"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="txtMin24HVolume" Grid.Column="0" 
                                     Text="100" Margin="0,0,5,0"
                                     ToolTip="æœ€å°24Hæˆäº¤é¢(ä¸‡)"/>
                            <TextBlock Grid.Column="1" Text="~" VerticalAlignment="Center" Margin="5,0"/>
                            <TextBox x:Name="txtMax24HVolume" Grid.Column="2" 
                                     Text="100000" Margin="5,0,0,0"
                                     ToolTip="æœ€å¤§24Hæˆäº¤é¢(ä¸‡)"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- å‡çº¿è·ç¦»å’Œå¤šç©ºé€‰æ‹© -->
                    <StackPanel Grid.Column="3">
                        <TextBlock Text="å‡çº¿è·ç¦»è®¾ç½®" FontWeight="Bold" Margin="0,0,0,5"/>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- è·ç¦»ç™¾åˆ†æ¯” -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
                                <TextBlock Text="è·ç¦»:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <TextBox x:Name="txtMaDistance" Text="3" Width="60" Margin="0,0,5,0"/>
                                <TextBlock Text="%" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <!-- å‡çº¿å‘¨æœŸ -->
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,5">
                                <TextBlock Text="å‡çº¿å‘¨æœŸ:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <TextBox x:Name="txtMaPeriod" Text="26" Width="60" Margin="0,0,5,0"/>
                                <TextBlock Text="å°æ—¶" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <!-- åŒä¾§Kçº¿æ•°é‡ -->
                            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,5">
                                <TextBlock Text="åŒä¾§Kçº¿æ•°:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <TextBox x:Name="txtSameSideCount" Text="10" Width="60" Margin="0,0,5,0"/>
                                <TextBlock Text="æ ¹" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <!-- å¤šç©ºé€‰æ‹© -->
                            <StackPanel Grid.Row="3" Orientation="Horizontal">
                                <RadioButton x:Name="rbLong" Content="å¤šå¤´" IsChecked="True" Margin="0,0,15,0"/>
                                <RadioButton x:Name="rbShort" Content="ç©ºå¤´"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Grid>
                
                <!-- æ“ä½œæŒ‰é’® -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                    <Button x:Name="btnSearch" Content="ðŸ” æ£€ç´¢" 
                            Width="140" Height="40" 
                            Background="#007ACC" Foreground="White"
                            FontSize="16" FontWeight="Bold"
                            Click="BtnSearch_Click" Margin="0,0,10,0"/>
                    <Button x:Name="btnClear" Content="æ¸…ç©ºæ¡ä»¶" 
                            Width="120" Height="40" 
                            Background="#6C757D" Foreground="White"
                            FontSize="16" FontWeight="Bold"
                            Click="BtnClear_Click" Margin="0,0,10,0"/>
                    <Button x:Name="btnExport" Content="å¯¼å‡ºç»“æžœ" 
                            Width="120" Height="40" 
                            Background="#28A745" Foreground="White"
                            FontSize="16" FontWeight="Bold"
                            Click="BtnExport_Click"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- ç»“æžœåˆ—è¡¨åŒºåŸŸ -->
        <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="10" Margin="10,5,10,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- ç»“æžœæ ‡é¢˜å’Œç›‘æŽ§æŒ‰é’® -->
                <Grid Grid.Row="0" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" x:Name="txtResultTitle" 
                               Text="æ£€ç´¢ç»“æžœ" FontSize="18" FontWeight="Bold" 
                               Foreground="#333333" VerticalAlignment="Center"/>
                    
                    <Button Grid.Column="1" x:Name="btnMonitor" Content="å¼€å§‹ç›‘æŽ§" 
                            Width="120" Height="35" Background="#28A745" 
                            Foreground="White" FontWeight="Bold" 
                            Click="BtnMonitor_Click"/>
                </Grid>
                
                <!-- ç»“æžœåˆ—è¡¨å’Œç›‘æŽ§åˆ—è¡¨ -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="300"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- ä¸»ç»“æžœåˆ—è¡¨ -->
                    <DataGrid Grid.Column="0" x:Name="dgResults" 
                              AutoGenerateColumns="False" 
                              CanUserAddRows="False" 
                              CanUserDeleteRows="False"
                              IsReadOnly="True"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              AlternatingRowBackground="#F8F9FA"
                              RowHeaderWidth="0"
                              SelectionMode="Single"
                              MouseDoubleClick="DgResults_MouseDoubleClick">
                    
                    <DataGrid.Columns>
                        <!-- åˆçº¦å -->
                        <DataGridTextColumn Header="åˆçº¦å" Binding="{Binding Symbol}" 
                                            Width="120" FontWeight="Bold"/>
                        
                        <!-- 24Hæ¶¨å¹… -->
                        <DataGridTextColumn Header="24Hæ¶¨å¹…" Binding="{Binding PriceChangePercent, StringFormat=F2}" 
                                            Width="100">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{Binding PriceChangePercent, Converter={StaticResource PriceChangeColorConverter}}"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        
                        <!-- 24Hæˆäº¤é¢(ä¸‡) -->
                        <DataGridTextColumn Header="24Hæˆäº¤é¢(ä¸‡)" Binding="{Binding Volume24H, StringFormat=F2}" 
                                            Width="120"/>
                        
                        <!-- æµé€šå¸‚å€¼(ä¸‡) -->
                        <DataGridTextColumn Header="æµé€šå¸‚å€¼(ä¸‡)" Binding="{Binding CirculatingMarketCap, StringFormat=F2}" 
                                            Width="120"/>
                        
                        <!-- æ€»å¸‚å€¼(ä¸‡) -->
                        <DataGridTextColumn Header="æ€»å¸‚å€¼(ä¸‡)" Binding="{Binding TotalMarketCap, StringFormat=F2}" 
                                            Width="120"/>
                        
                        <!-- æµé€šçŽ‡ -->
                        <DataGridTextColumn Header="æµé€šçŽ‡" Binding="{Binding CirculatingRatio, StringFormat=P2}" 
                                            Width="80"/>
                        
                        <!-- é‡æ¯” -->
                        <DataGridTextColumn Header="é‡æ¯”" Binding="{Binding VolumeRatio, StringFormat=F2}" 
                                            Width="80" FontWeight="Bold">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{Binding VolumeRatio, Converter={StaticResource VolumeRatioColorConverter}}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        
                        <!-- 26å°æ—¶å‡çº¿è·ç¦» -->
                        <DataGridTextColumn Header="26Hå‡çº¿è·ç¦»" Binding="{Binding MaDistancePercent, StringFormat=F2}" 
                                            Width="120">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{Binding MaDistancePercent, Converter={StaticResource MaDistanceColorConverter}}"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        
                        <!-- æœ€æ–°ä»·æ ¼ -->
                        <DataGridTextColumn Header="æœ€æ–°ä»·æ ¼" Binding="{Binding LastPrice, StringFormat=F8}" 
                                            Width="120"/>
                        
                        <!-- 26å°æ—¶å‡çº¿ä»·æ ¼ -->
                        <DataGridTextColumn Header="26Hå‡çº¿ä»·æ ¼" Binding="{Binding Ma26Price, StringFormat=F8}" 
                                            Width="120"/>
                        
                        <!-- åŒä¾§Kçº¿æ•°æ”¶ -->
                        <DataGridTextColumn Header="åŒä¾§Kçº¿æ•°æ”¶" Binding="{Binding SameSideCloseCount}" 
                                            Width="100" FontWeight="Bold"/>
                        
                        <!-- åŒä¾§Kçº¿æ•°æœ€ -->
                        <DataGridTextColumn Header="åŒä¾§Kçº¿æ•°æœ€" Binding="{Binding SameSideExtremeCount}" 
                                            Width="100" FontWeight="Bold"/>
                    </DataGrid.Columns>
                </DataGrid>
                
                <!-- åˆ†éš”çº¿ -->
                <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" 
                              Background="#E0E0E0" Width="1"/>
                
                <!-- è·ç¦»ç›‘æŽ§åˆ—è¡¨ -->
                <Border Grid.Column="2" Background="#F8F9FA" CornerRadius="5" Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- ç›‘æŽ§åˆ—è¡¨æ ‡é¢˜ -->
                        <TextBlock Grid.Row="0" Text="ç¬¦åˆè·ç¦»ç›‘æŽ§åˆ—è¡¨" 
                                   FontSize="14" FontWeight="Bold" 
                                   Foreground="#333333" Margin="0,0,0,10"/>
                        
                        <!-- ç›‘æŽ§åˆ—è¡¨ -->
                        <DataGrid Grid.Row="1" x:Name="dgMonitorResults" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False"
                                  IsReadOnly="True"
                                  GridLinesVisibility="Horizontal"
                                  HeadersVisibility="Column"
                                  AlternatingRowBackground="#FFFFFF"
                                  RowHeaderWidth="0"
                                  SelectionMode="Single"
                                  MouseDoubleClick="DgMonitorResults_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="åˆçº¦å" Binding="{Binding Symbol}" 
                                                    Width="100" FontWeight="Bold"/>
                                <DataGridTextColumn Header="è·ç¦»" Binding="{Binding MaDistancePercent, StringFormat=F2}" 
                                                    Width="60">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="{Binding MaDistancePercent, Converter={StaticResource MaDistanceColorConverter}}"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="æ—¶é—´" Binding="{Binding UpdateTime, StringFormat=HH:mm:ss}" 
                                                    Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
                </Grid>
            </Grid>
        </Border>
        
        <!-- çŠ¶æ€æ  -->
        <StatusBar Grid.Row="2" Background="#F8F9FA" Height="30">
            <StatusBarItem>
                <TextBlock x:Name="txtStatus" Text="å°±ç»ª" />
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="txtLastUpdate" Text="" FontSize="10" Foreground="Gray"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
