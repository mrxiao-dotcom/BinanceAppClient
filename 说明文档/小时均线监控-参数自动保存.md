# å°æ—¶å‡çº¿ç›‘æ§ - å‚æ•°è‡ªåŠ¨ä¿å­˜åŠŸèƒ½

**åŠŸèƒ½ç‰ˆæœ¬**: v1.3.1  
**å®ç°æ—¥æœŸ**: 2024-11-08  
**åŠŸèƒ½ç±»å‹**: ç”¨æˆ·ä½“éªŒä¼˜åŒ–

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

å°æ—¶å‡çº¿ç›‘æ§çª—å£ç°åœ¨æ”¯æŒ**å‚æ•°è‡ªåŠ¨ä¿å­˜**åŠŸèƒ½ï¼Œçª—å£å…³é—­æ—¶è‡ªåŠ¨ä¿å­˜æ‰€æœ‰å‚æ•°å’Œç­›é€‰æ¡ä»¶ï¼Œä¸‹æ¬¡æ‰“å¼€æ—¶è‡ªåŠ¨æ¢å¤ä¸Šæ¬¡ä½¿ç”¨çš„é…ç½®ã€‚

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

### 1. è‡ªåŠ¨ä¿å­˜
- âœ… çª—å£å…³é—­æ—¶è‡ªåŠ¨ä¿å­˜æ‰€æœ‰å‚æ•°
- âœ… æ— éœ€ç”¨æˆ·æ‰‹åŠ¨æ“ä½œ
- âœ… ä¿å­˜å¤±è´¥ä¸å½±å“çª—å£å…³é—­

### 2. è‡ªåŠ¨åŠ è½½
- âœ… çª—å£æ‰“å¼€æ—¶è‡ªåŠ¨åŠ è½½ä¸Šæ¬¡é…ç½®
- âœ… å¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å€¼
- âœ… åŠ è½½å¤±è´¥ä¸å½±å“çª—å£æ‰“å¼€

### 3. å®Œæ•´é…ç½®
ä¿å­˜ä»¥ä¸‹æ‰€æœ‰å‚æ•°ï¼š
- **Nå¤©å‡çº¿** (EmaPeriod)
- **Xæ ¹Kçº¿** (KlineCount)
- **å¤§äºEMAæ•°é‡** (MinAboveEmaCount)
- **å°äºEMAæ•°é‡** (MinBelowEmaCount)
- **æˆäº¤é¢ç­›é€‰** (MinQuoteVolume)
- **é‡æ¯”ç­›é€‰** (MinVolumeRatio)
- **æµé€šç‡ç­›é€‰** (MaxCirculationRate)
- **æµé€šå¸‚å€¼ç­›é€‰** (MaxCirculatingMarketCap)
- **å‘è¡Œå¸‚å€¼ç­›é€‰** (MaxTotalMarketCap)

## ğŸ“ é…ç½®æ–‡ä»¶

### æ–‡ä»¶ä½ç½®
```
./hourly_ema_config.json
```

é…ç½®æ–‡ä»¶ä¿å­˜åœ¨ç¨‹åºè¿è¡Œç›®å½•ä¸‹ï¼Œä¸ä¸»ç¨‹åºåœ¨åŒä¸€æ–‡ä»¶å¤¹ã€‚

### æ–‡ä»¶æ ¼å¼

```json
{
  "parameters": {
    "emaPeriod": 26,
    "klineCount": 100
  },
  "filter": {
    "minAboveEmaCount": 5,
    "minBelowEmaCount": null,
    "minQuoteVolume": 1000000,
    "minVolumeRatio": 5,
    "maxCirculationRate": 50,
    "maxCirculatingMarketCap": 100000000,
    "maxTotalMarketCap": 500000000
  },
  "lastSaved": "2024-11-08T15:30:00"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `emaPeriod` | int | Nå¤©å‡çº¿å‘¨æœŸ | 26 |
| `klineCount` | int | è·å–Kçº¿æ ¹æ•° | 100 |
| `minAboveEmaCount` | int? | æœ€å°å¤§äºEMAæ•°é‡ | null |
| `minBelowEmaCount` | int? | æœ€å°å°äºEMAæ•°é‡ | null |
| `minQuoteVolume` | decimal? | æœ€å°24Hæˆäº¤é¢(USDT) | null |
| `minVolumeRatio` | decimal? | æœ€å°é‡æ¯”(%) | null |
| `maxCirculationRate` | decimal? | æœ€å¤§æµé€šç‡(%) | null |
| `maxCirculatingMarketCap` | decimal? | æœ€å¤§æµé€šå¸‚å€¼(USDT) | null |
| `maxTotalMarketCap` | decimal? | æœ€å¤§å‘è¡Œå¸‚å€¼(USDT) | null |
| `lastSaved` | DateTime | æœ€åä¿å­˜æ—¶é—´ | å½“å‰æ—¶é—´ |

**æ³¨æ„**: `null` å€¼è¡¨ç¤ºè¯¥ç­›é€‰æ¡ä»¶æœªè®¾ç½®ï¼ˆä¸å¯ç”¨ï¼‰ã€‚

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. é…ç½®æ¨¡å‹

**æ–‡ä»¶**: `src/BinanceApps.Core/Models/HourlyEmaModels.cs`

```csharp
/// <summary>
/// å°æ—¶å‡çº¿ç›‘æ§é…ç½®ï¼ˆç”¨äºæœ¬åœ°ä¿å­˜ï¼‰
/// </summary>
public class HourlyEmaConfig
{
    /// <summary>
    /// å‚æ•°é…ç½®
    /// </summary>
    public HourlyEmaParameters Parameters { get; set; } = new HourlyEmaParameters();
    
    /// <summary>
    /// ç­›é€‰æ¡ä»¶
    /// </summary>
    public HourlyEmaFilter Filter { get; set; } = new HourlyEmaFilter();
    
    /// <summary>
    /// æœ€åä¿å­˜æ—¶é—´
    /// </summary>
    public DateTime LastSaved { get; set; } = DateTime.Now;
}
```

### 2. ä¿å­˜é…ç½®æ–¹æ³•

**æ–‡ä»¶**: `src/BinanceApps.WPF/HourlyEmaMonitorWindow.xaml.cs`

```csharp
/// <summary>
/// ä¿å­˜é…ç½®
/// </summary>
private void SaveConfig()
{
    try
    {
        var config = new HourlyEmaConfig
        {
            Parameters = new HourlyEmaParameters
            {
                EmaPeriod = int.TryParse(txtEmaPeriod.Text, out var emaPeriod) ? emaPeriod : 26,
                KlineCount = int.TryParse(txtKlineCount.Text, out var klineCount) ? klineCount : 100
            },
            Filter = new HourlyEmaFilter
            {
                MinAboveEmaCount = int.TryParse(txtMinAboveEma.Text, out var minAbove) ? minAbove : null,
                MinBelowEmaCount = int.TryParse(txtMinBelowEma.Text, out var minBelow) ? minBelow : null,
                MinQuoteVolume = decimal.TryParse(txtMinQuoteVolume.Text, out var minVolume) ? minVolume : null,
                MinVolumeRatio = decimal.TryParse(txtMinVolumeRatio.Text, out var minRatio) ? minRatio : null,
                MaxCirculationRate = decimal.TryParse(txtMaxCirculationRate.Text, out var maxCirculation) ? maxCirculation : null,
                MaxCirculatingMarketCap = decimal.TryParse(txtMaxCirculatingMarketCap.Text, out var maxCirculatingCap) ? maxCirculatingCap : null,
                MaxTotalMarketCap = decimal.TryParse(txtMaxTotalMarketCap.Text, out var maxTotalCap) ? maxTotalCap : null
            },
            LastSaved = DateTime.Now
        };

        var options = new JsonSerializerOptions
        {
            WriteIndented = true,
            PropertyNamingPolicy = JsonNamingPolicy.CamelCase
        };

        var json = JsonSerializer.Serialize(config, options);
        File.WriteAllText(ConfigFilePath, json);

        Console.WriteLine($"ğŸ’¾ å·²ä¿å­˜é…ç½®: N={config.Parameters.EmaPeriod}, X={config.Parameters.KlineCount}");
    }
    catch (Exception ex)
    {
        _logger?.LogError(ex, "ä¿å­˜é…ç½®å¤±è´¥");
        Console.WriteLine($"âš ï¸ ä¿å­˜é…ç½®å¤±è´¥: {ex.Message}");
        // ä¿å­˜å¤±è´¥ä¸å½±å“ä½¿ç”¨
    }
}
```

**ç‰¹ç‚¹**:
- ä½¿ç”¨ `TryParse` å®‰å…¨è§£æè¾“å…¥å€¼
- ç©ºå€¼ä½¿ç”¨ `null` è¡¨ç¤ºæœªè®¾ç½®
- ä¿å­˜å¤±è´¥ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œåªè®°å½•æ—¥å¿—

### 3. åŠ è½½é…ç½®æ–¹æ³•

```csharp
/// <summary>
/// åŠ è½½é…ç½®
/// </summary>
private void LoadConfig()
{
    try
    {
        if (!File.Exists(ConfigFilePath))
        {
            Console.WriteLine("ğŸ“‹ é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å‚æ•°");
            return;
        }

        var json = File.ReadAllText(ConfigFilePath);
        var config = JsonSerializer.Deserialize<HourlyEmaConfig>(json);

        if (config != null)
        {
            // åŠ è½½å‚æ•°
            if (config.Parameters != null)
            {
                txtEmaPeriod.Text = config.Parameters.EmaPeriod.ToString();
                txtKlineCount.Text = config.Parameters.KlineCount.ToString();
            }

            // åŠ è½½ç­›é€‰æ¡ä»¶
            if (config.Filter != null)
            {
                txtMinAboveEma.Text = config.Filter.MinAboveEmaCount?.ToString() ?? "";
                txtMinBelowEma.Text = config.Filter.MinBelowEmaCount?.ToString() ?? "";
                txtMinQuoteVolume.Text = config.Filter.MinQuoteVolume?.ToString() ?? "";
                txtMinVolumeRatio.Text = config.Filter.MinVolumeRatio?.ToString() ?? "";
                txtMaxCirculationRate.Text = config.Filter.MaxCirculationRate?.ToString() ?? "";
                txtMaxCirculatingMarketCap.Text = config.Filter.MaxCirculatingMarketCap?.ToString() ?? "";
                txtMaxTotalMarketCap.Text = config.Filter.MaxTotalMarketCap?.ToString() ?? "";
            }

            Console.WriteLine($"âœ… æˆåŠŸåŠ è½½é…ç½®: N={config.Parameters?.EmaPeriod}, X={config.Parameters?.KlineCount}");
        }
    }
    catch (Exception ex)
    {
        _logger?.LogError(ex, "åŠ è½½é…ç½®å¤±è´¥");
        Console.WriteLine($"âš ï¸ åŠ è½½é…ç½®å¤±è´¥: {ex.Message}");
        // åŠ è½½å¤±è´¥ä¸å½±å“ä½¿ç”¨ï¼Œç»§ç»­ä½¿ç”¨é»˜è®¤å€¼
    }
}
```

**ç‰¹ç‚¹**:
- æ–‡ä»¶ä¸å­˜åœ¨æ—¶ä½¿ç”¨é»˜è®¤å€¼
- `null` å€¼æ˜¾ç¤ºä¸ºç©ºå­—ç¬¦ä¸²
- åŠ è½½å¤±è´¥ä¸å½±å“çª—å£æ‰“å¼€

### 4. è‡ªåŠ¨è§¦å‘

```csharp
private void InitializeWindow()
{
    // ... å…¶ä»–åˆå§‹åŒ–ä»£ç  ...
    
    // åŠ è½½ä¸Šæ¬¡ä¿å­˜çš„é…ç½®
    LoadConfig();
    
    // ... å…¶ä»–åˆå§‹åŒ–ä»£ç  ...
}

protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
{
    // ä¿å­˜é…ç½®
    SaveConfig();
    
    // ... å…¶ä»–å…³é—­é€»è¾‘ ...
    
    base.OnClosing(e);
}
```

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæ—¥å¸¸ä½¿ç”¨
```
ç¬¬ä¸€å¤©ï¼š
1. æ‰“å¼€çª—å£ï¼Œè¾“å…¥å‚æ•° N=50, X=200
2. è®¾ç½®ç­›é€‰ï¼šæˆäº¤é¢ â‰¥ 100ä¸‡, é‡æ¯” â‰¥ 5%
3. è¿›è¡Œåˆ†æ
4. å…³é—­çª—å£ â†’ è‡ªåŠ¨ä¿å­˜é…ç½®

ç¬¬äºŒå¤©ï¼š
1. æ‰“å¼€çª—å£ â†’ è‡ªåŠ¨åŠ è½½å‚æ•° N=50, X=200
2. è‡ªåŠ¨åŠ è½½ç­›é€‰æ¡ä»¶
3. ç›´æ¥ç‚¹å‡»"è·å–å°æ—¶Kçº¿"å³å¯
```

### åœºæ™¯2ï¼šä¸åŒç­–ç•¥åˆ‡æ¢
```
ç­–ç•¥Aï¼ˆé•¿æœŸï¼‰ï¼š
- N=50, X=200
- ç­›é€‰ï¼šæˆäº¤é¢ â‰¥ 100ä¸‡

ç­–ç•¥Bï¼ˆçŸ­æœŸï¼‰ï¼š
- N=26, X=100
- ç­›é€‰ï¼šé‡æ¯” â‰¥ 10%

æ¯æ¬¡åˆ‡æ¢ç­–ç•¥æ—¶ï¼Œè¾“å…¥æ–°å‚æ•°ï¼Œå…³é—­çª—å£è‡ªåŠ¨ä¿å­˜ã€‚
ä¸‹æ¬¡æ‰“å¼€æ—¶è‡ªåŠ¨åŠ è½½ä¸Šæ¬¡ä½¿ç”¨çš„ç­–ç•¥å‚æ•°ã€‚
```

### åœºæ™¯3ï¼šæ–°ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨
```
1. é¦–æ¬¡æ‰“å¼€çª—å£
2. é…ç½®æ–‡ä»¶ä¸å­˜åœ¨
3. è‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼ï¼šN=26, X=100
4. æ‰€æœ‰ç­›é€‰æ¡ä»¶ä¸ºç©ºï¼ˆä¸å¯ç”¨ï¼‰
5. ç”¨æˆ·ä¿®æ”¹åå…³é—­ï¼Œä¸‹æ¬¡æ‰“å¼€è‡ªåŠ¨åŠ è½½
```

## ğŸ¨ ç”¨æˆ·ä½“éªŒæ”¹è¿›

### ä¼˜åŠ¿

1. **æ— éœ€è®°å¿†å‚æ•°**
   - è‡ªåŠ¨ä¿å­˜å¸¸ç”¨å‚æ•°ç»„åˆ
   - é¿å…æ¯æ¬¡æ‰“å¼€éƒ½è¦é‡æ–°è¾“å…¥

2. **å¿«é€Ÿå¯åŠ¨**
   - æ‰“å¼€çª—å£å³åˆ»å°±ç»ª
   - æ— éœ€é‡æ–°é…ç½®

3. **ç­–ç•¥å»¶ç»­**
   - ä¿æŒåˆ†æç­–ç•¥çš„è¿è´¯æ€§
   - è‡ªåŠ¨ç»§æ‰¿ä¸Šæ¬¡çš„ç­›é€‰æ¡ä»¶

4. **é›¶å­¦ä¹ æˆæœ¬**
   - å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€ç”¨æˆ·å¹²é¢„
   - é€æ˜è¿è¡Œï¼Œä¸æ‰“æ‰°ç”¨æˆ·

### ç»†èŠ‚ä¼˜åŒ–

- âœ… **æ™ºèƒ½é»˜è®¤å€¼**: é¦–æ¬¡ä½¿ç”¨æœ‰åˆç†çš„é»˜è®¤å‚æ•°
- âœ… **å®¹é”™å¤„ç†**: é…ç½®æŸåä¸å½±å“ä½¿ç”¨
- âœ… **å¯è¯»æ ¼å¼**: JSONæ ¼å¼æ–¹ä¾¿æ‰‹åŠ¨ç¼–è¾‘
- âœ… **æ¸…æ™°æ—¥å¿—**: ä¿å­˜/åŠ è½½è¿‡ç¨‹æœ‰æ—¥å¿—è¾“å‡º

## ğŸ› å¼‚å¸¸å¤„ç†

### 1. é…ç½®æ–‡ä»¶ä¸å­˜åœ¨
**å¤„ç†**: ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸æŠ¥é”™

```
ğŸ“‹ é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤å‚æ•°
```

### 2. é…ç½®æ–‡ä»¶æŸå
**å¤„ç†**: ä½¿ç”¨é»˜è®¤å€¼ï¼Œè®°å½•è­¦å‘Šæ—¥å¿—

```
âš ï¸ åŠ è½½é…ç½®å¤±è´¥: Invalid JSON format
```

### 3. ä¿å­˜å¤±è´¥ï¼ˆç£ç›˜æ»¡ã€æƒé™é—®é¢˜ç­‰ï¼‰
**å¤„ç†**: è®°å½•é”™è¯¯æ—¥å¿—ï¼Œä¸é˜»æ­¢çª—å£å…³é—­

```
âš ï¸ ä¿å­˜é…ç½®å¤±è´¥: Access denied
```

### 4. å‚æ•°è¾“å…¥éæ³•
**å¤„ç†**: ä½¿ç”¨é»˜è®¤å€¼æ›¿ä»£

```csharp
// ä¾‹å¦‚ï¼šEmaPeriodè¾“å…¥äº†éæ•°å­—
EmaPeriod = int.TryParse(txtEmaPeriod.Text, out var emaPeriod) ? emaPeriod : 26
```

## ğŸ”„ ç‰ˆæœ¬å…¼å®¹æ€§

### å‘åå…¼å®¹
- âœ… æ—§ç‰ˆæœ¬æ²¡æœ‰é…ç½®æ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼
- âœ… é…ç½®æ–‡ä»¶ç¼ºå°‘å­—æ®µæ—¶ï¼Œä½¿ç”¨é»˜è®¤å€¼å¡«å……
- âœ… é…ç½®æ–‡ä»¶æ ¼å¼å˜æ›´æ—¶ï¼Œä¼˜é›…é™çº§

### æœªæ¥æ‰©å±•
é…ç½®æ¨¡å‹è®¾è®¡æ”¯æŒæœªæ¥æ‰©å±•ï¼š
- å¯æ·»åŠ æ–°çš„ç­›é€‰æ¡ä»¶
- å¯æ·»åŠ çª—å£å¸ƒå±€ä¿¡æ¯
- å¯æ·»åŠ æ˜¾ç¤ºåå¥½è®¾ç½®

## ğŸ“ æ‰‹åŠ¨ç¼–è¾‘é…ç½®

å¦‚æœéœ€è¦æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š

1. **å…³é—­åº”ç”¨ç¨‹åº**
2. **ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€** `hourly_ema_config.json`
3. **ä¿®æ”¹å‚æ•°å€¼**
4. **ä¿å­˜æ–‡ä»¶**
5. **é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åº**

**ç¤ºä¾‹ï¼šæ‰¹é‡è®¾ç½®ç­›é€‰æ¡ä»¶**

```json
{
  "parameters": {
    "emaPeriod": 50,
    "klineCount": 200
  },
  "filter": {
    "minAboveEmaCount": 5,
    "minBelowEmaCount": null,
    "minQuoteVolume": 5000000,
    "minVolumeRatio": 10,
    "maxCirculationRate": 30,
    "maxCirculatingMarketCap": 50000000,
    "maxTotalMarketCap": 200000000
  },
  "lastSaved": "2024-11-08T15:30:00"
}
```

## ğŸ“„ ç›¸å…³æ–‡æ¡£

- [å°æ—¶å‡çº¿ç›‘æ§åŠŸèƒ½è¯´æ˜](./å°æ—¶å‡çº¿ç›‘æ§åŠŸèƒ½è¯´æ˜.md)
- [å°æ—¶å‡çº¿ç›‘æ§ - é«˜çº§ç­›é€‰æ¡ä»¶](./å°æ—¶å‡çº¿ç›‘æ§-é«˜çº§ç­›é€‰æ¡ä»¶.md)
- [å°æ—¶å‡çº¿ç›‘æ§ - Kçº¿åŠ è½½æ€§èƒ½ä¼˜åŒ–](./å°æ—¶å‡çº¿ç›‘æ§-Kçº¿åŠ è½½æ€§èƒ½ä¼˜åŒ–.md)

---

**åŠŸèƒ½å®ç°æ—¶é—´**: 2024-11-08  
**æµ‹è¯•çŠ¶æ€**: âœ… å·²é€šè¿‡ç¼–è¯‘æµ‹è¯•

