# 自定义板块监控功能 - 快速测试指南

## ✅ 集成完成！

所有代码已成功集成到主程序中。

---

## 🚀 快速测试步骤

### 1. 编译项目
```bash
cd D:\CSharpProjects\BinanceAppsClient
dotnet build src/BinanceApps.WPF/BinanceApps.WPF.csproj -c Release
```

### 2. 运行应用
双击运行生成的可执行文件，或使用命令：
```bash
dotnet run --project src/BinanceApps.WPF/BinanceApps.WPF.csproj
```

### 3. 打开自定义板块监控
- 在主窗口菜单栏，点击：**工具** → **自定义板块监控**

### 4. 创建第一个组合（示例）
1. 点击 **"创建组合"** 按钮
2. 填写信息：
   - **组合名称**: 主流币板块
   - **组合说明**: 包含比特币、以太坊等主流加密货币
3. 搜索并添加合约：
   - 在搜索框输入 **"BTC"**，点击搜索
   - 找到 **BTCUSDT**，点击 **"添加"**
   - 在备注框输入：比特币
   - 再搜索 **"ETH"**，添加 **ETHUSDT**
   - 在备注框输入：以太坊
4. 点击 **"保存"**

### 5. 查看组合数据
- 在左侧组合列表中，应该能看到：
  - 组合名称：主流币板块
  - 平均涨幅：+X.XX% ↑（绿色，根据实时行情）
  - 成分数：2个合约
- 点击组合，右侧会显示详细数据：
  - BTCUSDT 的涨幅、价格、成交额
  - ETHUSDT 的涨幅、价格、成交额

### 6. 测试自动刷新
- 等待5秒，观察：
  - 涨幅数据是否自动更新
  - "最后更新"时间是否刷新

### 7. 测试修改功能
- 点击组合旁边的 **"修改"** 按钮
- 尝试添加更多合约（如 BNBUSDT）
- 修改备注内容
- 点击 **"保存"**

### 8. 测试数据持久化
- 关闭自定义板块监控窗口
- 重新打开：**工具** → **自定义板块监控**
- 确认数据是否还在

### 9. 测试删除功能
- 创建一个测试组合
- 点击 **"删除"** 按钮
- 确认删除

---

## ✅ 验收标准

### 功能验收
- [ ] 菜单项正确显示
- [ ] 能成功打开自定义板块监控窗口
- [ ] 能创建组合
- [ ] 能搜索合约
- [ ] 能添加合约到组合
- [ ] 能为合约添加备注
- [ ] 能修改组合
- [ ] 能删除组合
- [ ] 涨幅数据正确显示
- [ ] 涨幅颜色正确（涨绿跌红）
- [ ] 每5秒自动刷新
- [ ] 数据持久化（重启后数据保留）

### UI验收
- [ ] 界面美观、布局合理
- [ ] 按钮响应正常
- [ ] 搜索功能流畅
- [ ] 列表滚动正常
- [ ] 窗口大小合适

---

## 🐛 常见问题排查

### 问题 1：菜单中没有"自定义板块监控"选项
**原因**: XAML 未正确保存或编译
**解决**: 重新编译项目

### 问题 2：点击菜单报错"服务未初始化"
**原因**: CustomPortfolioService 未正确初始化
**解决**: 
1. 检查控制台日志，查看是否有"自定义板块服务初始化完成"
2. 确认服务在 InitializeAsync 中正确初始化

### 问题 3：无法获取行情数据
**原因**: API 未连接或网络问题
**解决**: 
1. 检查主窗口是否显示"公开API模式初始化成功"
2. 检查网络连接
3. 尝试手动点击"刷新数据"

### 问题 4：数据没有持久化
**原因**: AppData 目录无写权限
**解决**: 
1. 查看控制台日志中的存储路径
2. 检查 `%LocalAppData%\BinanceApps\custom_portfolios.json` 是否存在
3. 确认当前用户有写权限

### 问题 5：编译错误
**原因**: 缺少依赖或代码冲突
**解决**: 
1. 运行 `dotnet restore` 恢复 NuGet 包
2. 清理并重新生成：
   ```bash
   dotnet clean
   dotnet build
   ```

---

## 📊 测试数据示例

可以创建以下测试组合来全面测试功能：

### 1. 主流币板块
- BTCUSDT（比特币）
- ETHUSDT（以太坊）
- BNBUSDT（币安币）
- XRPUSDT（瑞波币）

### 2. DeFi 板块
- UNIUSDT（Uniswap）
- AAVEUSDT（Aave）
- SUSHIUSDT（Sushi）

### 3. Layer2 板块
- MATICUSDT（Polygon）
- ARBUSDT（Arbitrum）
- OPUSDT（Optimism）

### 4. Meme 板块
- DOGEUSDT（狗狗币）
- SHIBU SDT（柴犬币）
- PEPEUSDT（佩佩币）

---

## 📝 测试报告模板

```
测试日期: ____________________
测试人员: ____________________

【基础功能测试】
□ 创建组合: ___（通过/失败）
□ 修改组合: ___（通过/失败）
□ 删除组合: ___（通过/失败）
□ 搜索合约: ___（通过/失败）
□ 添加合约: ___（通过/失败）
□ 自动刷新: ___（通过/失败）
□ 数据持久化: ___（通过/失败）

【性能测试】
□ 创建10个组合: ___（通过/失败）
□ 每个组合20个合约: ___（通过/失败）
□ 刷新速度: ___ 秒
□ 搜索响应: ___ 秒

【问题记录】
问题1: _____________________________
问题2: _____________________________
问题3: _____________________________

【整体评价】
_____________________________________
```

---

## 🎯 下一步优化建议（可选）

1. **短期优化**
   - [ ] 添加组合排序功能（按名称、涨幅）
   - [ ] 添加导出功能（导出为CSV/JSON）
   - [ ] 添加组合复制功能

2. **中期优化**
   - [ ] 添加组合性能图表
   - [ ] 添加告警功能（涨幅达到阈值）
   - [ ] 添加批量操作（批量删除）

3. **长期优化**
   - [ ] 历史涨幅趋势分析
   - [ ] 组合对比功能
   - [ ] 云端同步（可选）

---

**测试愉快！如有问题，请查看集成指南或联系技术支持。** 